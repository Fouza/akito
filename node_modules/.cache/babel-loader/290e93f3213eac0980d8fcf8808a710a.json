{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\THINKPAD L480\\\\Desktop\\\\Work\\\\akito\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\THINKPAD L480\\\\Desktop\\\\Work\\\\akito\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\THINKPAD L480\\\\Desktop\\\\Work\\\\akito\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{useState}from\"react\";import{useCamera}from\"@ionic/react-hooks/camera\";import{useFilesystem,base64FromPath}from\"@ionic/react-hooks/filesystem\";import{isPlatform}from\"@ionic/react\";import{CameraResultType,CameraSource,Capacitor}from\"@capacitor/core\";import\"@ionic/pwa-elements\";export function usePhotoGallery(){var _useCamera=useCamera(),getPhoto=_useCamera.getPhoto;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),photos=_useState2[0],setPhotos=_useState2[1];var _useFilesystem=useFilesystem(),deleteFile=_useFilesystem.deleteFile,getUri=_useFilesystem.getUri,readFile=_useFilesystem.readFile,writeFile=_useFilesystem.writeFile;//taking\nvar takePhoto=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var cameraPhoto,fileName,savedFileImage,newPhotos;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getPhoto({resultType:CameraResultType.Uri,source:CameraSource.Camera,quality:100});case 2:cameraPhoto=_context.sent;fileName=new Date().getTime()+\".jpeg\";_context.next=6;return savePicture(cameraPhoto,fileName);case 6:savedFileImage=_context.sent;newPhotos=[savedFileImage];setPhotos(newPhotos);case 9:case\"end\":return _context.stop();}}},_callee);}));return function takePhoto(){return _ref.apply(this,arguments);};}();//saving\nvar savePicture=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(photo,fileName){var base64Data,file,savedFile;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!isPlatform(\"hybrid\")){_context2.next=7;break;}_context2.next=3;return readFile({path:photo.path});case 3:file=_context2.sent;base64Data=file.data;_context2.next=10;break;case 7:_context2.next=9;return base64FromPath(photo.webPath);case 9:base64Data=_context2.sent;case 10:_context2.next=12;return writeFile({path:fileName,data:base64Data// directory: FilesystemDirectory.Data,\n});case 12:savedFile=_context2.sent;if(!isPlatform(\"hybrid\")){_context2.next=17;break;}return _context2.abrupt(\"return\",{filepath:savedFile.uri,webviewPath:Capacitor.convertFileSrc(savedFile.uri),base64:base64Data});case 17:return _context2.abrupt(\"return\",{filepath:fileName,webviewPath:photo.webPath,base64:base64Data});case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function savePicture(_x,_x2){return _ref2.apply(this,arguments);};}();return{takePhoto:takePhoto,photos:photos};}","map":{"version":3,"sources":["C:/Users/THINKPAD L480/Desktop/Work/akito/src/hooks/usePhotoGallery.tsx"],"names":["useState","useCamera","useFilesystem","base64FromPath","isPlatform","CameraResultType","CameraSource","Capacitor","usePhotoGallery","getPhoto","photos","setPhotos","deleteFile","getUri","readFile","writeFile","takePhoto","resultType","Uri","source","Camera","quality","cameraPhoto","fileName","Date","getTime","savePicture","savedFileImage","newPhotos","photo","path","file","base64Data","data","webPath","savedFile","filepath","uri","webviewPath","convertFileSrc","base64"],"mappings":"2fAAA,OAASA,QAAT,KAAoC,OAApC,CACA,OAASC,SAAT,KAA0B,2BAA1B,CACA,OAASC,aAAT,CAAwBC,cAAxB,KAA8C,+BAA9C,CAEA,OAASC,UAAT,KAA2B,cAA3B,CACA,OACEC,gBADF,CAEEC,YAFF,CAIEC,SAJF,KAMO,iBANP,CAOA,MAAO,qBAAP,CAQA,MAAO,SAASC,CAAAA,eAAT,EAA2B,gBACXP,SAAS,EADE,CACxBQ,QADwB,YACxBA,QADwB,eAEJT,QAAQ,CAAU,EAAV,CAFJ,wCAEzBU,MAFyB,eAEjBC,SAFiB,kCAGoBT,aAAa,EAHjC,CAGxBU,UAHwB,gBAGxBA,UAHwB,CAGZC,MAHY,gBAGZA,MAHY,CAGJC,QAHI,gBAGJA,QAHI,CAGMC,SAHN,gBAGMA,SAHN,CAKhC;AACA,GAAMC,CAAAA,SAAS,0FAAG,2MACUP,CAAAA,QAAQ,CAAC,CACjCQ,UAAU,CAAEZ,gBAAgB,CAACa,GADI,CAEjCC,MAAM,CAAEb,YAAY,CAACc,MAFY,CAGjCC,OAAO,CAAE,GAHwB,CAAD,CADlB,QACVC,WADU,eAMVC,QANU,CAMC,GAAIC,CAAAA,IAAJ,GAAWC,OAAX,GAAuB,OANxB,uBAOaC,CAAAA,WAAW,CAACJ,WAAD,CAAcC,QAAd,CAPxB,QAOVI,cAPU,eAQVC,SARU,CAQE,CAACD,cAAD,CARF,CAShBhB,SAAS,CAACiB,SAAD,CAAT,CATgB,sDAAH,kBAATZ,CAAAA,SAAS,0CAAf,CAWA;AACA,GAAMU,CAAAA,WAAW,2FAAG,kBAClBG,KADkB,CAElBN,QAFkB,wJAMdnB,UAAU,CAAC,QAAD,CANI,iDAOGU,CAAAA,QAAQ,CAAC,CAC1BgB,IAAI,CAAED,KAAK,CAACC,IADc,CAAD,CAPX,QAOVC,IAPU,gBAUhBC,UAAU,CAAGD,IAAI,CAACE,IAAlB,CAVgB,sDAYG9B,CAAAA,cAAc,CAAC0B,KAAK,CAACK,OAAP,CAZjB,QAYhBF,UAZgB,gDAcMjB,CAAAA,SAAS,CAAC,CAChCe,IAAI,CAAEP,QAD0B,CAEhCU,IAAI,CAAED,UACN;AAHgC,CAAD,CAdf,SAcZG,SAdY,oBAoBd/B,UAAU,CAAC,QAAD,CApBI,4DAuBT,CACLgC,QAAQ,CAAED,SAAS,CAACE,GADf,CAELC,WAAW,CAAE/B,SAAS,CAACgC,cAAV,CAAyBJ,SAAS,CAACE,GAAnC,CAFR,CAGLG,MAAM,CAAER,UAHH,CAvBS,2CA+BT,CACLI,QAAQ,CAAEb,QADL,CAELe,WAAW,CAAET,KAAK,CAACK,OAFd,CAGLM,MAAM,CAAER,UAHH,CA/BS,2DAAH,kBAAXN,CAAAA,WAAW,iDAAjB,CAuCA,MAAO,CACLV,SAAS,CAATA,SADK,CAELN,MAAM,CAANA,MAFK,CAAP,CAID","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useCamera } from \"@ionic/react-hooks/camera\";\r\nimport { useFilesystem, base64FromPath } from \"@ionic/react-hooks/filesystem\";\r\nimport { useStorage } from \"@ionic/react-hooks/storage\";\r\nimport { isPlatform } from \"@ionic/react\";\r\nimport {\r\n  CameraResultType,\r\n  CameraSource,\r\n  CameraPhoto,\r\n  Capacitor,\r\n  FilesystemDirectory,\r\n} from \"@capacitor/core\";\r\nimport \"@ionic/pwa-elements\";\r\n\r\nexport interface Photo {\r\n  filepath: string;\r\n  webviewPath?: string;\r\n  base64?: string;\r\n}\r\n\r\nexport function usePhotoGallery() {\r\n  const { getPhoto } = useCamera();\r\n  const [photos, setPhotos] = useState<Photo[]>([]);\r\n  const { deleteFile, getUri, readFile, writeFile } = useFilesystem();\r\n\r\n  //taking\r\n  const takePhoto = async () => {\r\n    const cameraPhoto = await getPhoto({\r\n      resultType: CameraResultType.Uri,\r\n      source: CameraSource.Camera,\r\n      quality: 100,\r\n    });\r\n    const fileName = new Date().getTime() + \".jpeg\";\r\n    const savedFileImage = await savePicture(cameraPhoto, fileName);\r\n    const newPhotos = [savedFileImage];\r\n    setPhotos(newPhotos);\r\n  };\r\n  //saving\r\n  const savePicture = async (\r\n    photo: CameraPhoto,\r\n    fileName: string\r\n  ): Promise<Photo> => {\r\n    let base64Data: string;\r\n    // \"hybrid\" will detect Cordova or Capacitor;\r\n    if (isPlatform(\"hybrid\")) {\r\n      const file = await readFile({\r\n        path: photo.path!,\r\n      });\r\n      base64Data = file.data;\r\n    } else {\r\n      base64Data = await base64FromPath(photo.webPath!);\r\n    }\r\n    const savedFile = await writeFile({\r\n      path: fileName,\r\n      data: base64Data,\r\n      // directory: FilesystemDirectory.Data,\r\n    });\r\n\r\n    if (isPlatform(\"hybrid\")) {\r\n      // Display the new image by rewriting the 'file://' path to HTTP\r\n      // Details: https://ionicframework.com/docs/building/webview#file-protocol\r\n      return {\r\n        filepath: savedFile.uri,\r\n        webviewPath: Capacitor.convertFileSrc(savedFile.uri),\r\n        base64: base64Data,\r\n      };\r\n    } else {\r\n      // Use webPath to display the new image instead of base64 since it's\r\n      // already loaded into memory\r\n      return {\r\n        filepath: fileName,\r\n        webviewPath: photo.webPath,\r\n        base64: base64Data,\r\n      };\r\n    }\r\n  };\r\n\r\n  return {\r\n    takePhoto,\r\n    photos,\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}